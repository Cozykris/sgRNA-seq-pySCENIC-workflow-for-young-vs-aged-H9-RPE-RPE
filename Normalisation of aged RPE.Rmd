---
title: "analysis of aged H9 RPE"
author: "Chris Hui"
date: "2025-08-07"
output: html_document
---

```{r}
library(tidyverse)
library(ggpubr)
library(ggExtra)


Aged <- read.delim("/Users/Chris1219/Desktop/H9_RPE_AGED_RawCountMatrix.tsv",
                          header = TRUE,
                          row.names = 1,
                          check.names = FALSE)
```

```{r}
library(Seurat)
seurat_obj_aged <- CreateSeuratObject(Aged, project = "RPE_scRNA")
seurat_obj_aged[["condition"]] <- "Aged"

seurat_obj_aged[["percent.mt"]] <- PercentageFeatureSet(seurat_obj_aged, pattern = "^MT-")
seurat_obj_aged[["percent.rb"]] <- PercentageFeatureSet(seurat_obj_aged, pattern = "^RPS|^RPL")
```


```{r}
seurat_obj_aged <- SCTransform(seurat_obj_aged, 
                          vars.to.regress = c("percent.mt", "percent.rb"),
                          conserve.memory = TRUE, verbose = FALSE)
```

```{r}
# Principal component analysis
seurat_obj_aged <- RunPCA(seurat_obj_aged, verbose = FALSE)

# UMAP
seurat_obj_aged <- RunUMAP(seurat_obj_aged, dims = 1:30, umap.method = "uwot")
```

```{r}
DimPlot(seurat_obj_aged, reduction = "pca") 
```

```{r}
DimPlot(seurat_obj_aged, reduction = "umap")
```

```{r}
saveRDS(seurat_obj_aged, file = "/Users/chris1219/Desktop/H9_RPE_AGED_Analysed_Object.rds")
```
