---
title: "analysis of young sc RNA seq"
author: "Chris Hui"
date: "2025-08-11"
output: html_document
---

```{r}
library(Seurat)
library(tidyverse)
library(ggpubr)
library(ggExtra)
```

```{r}
Young <- read.table("/users/Chris1219/Desktop/H9_RPE_YOUNG_RawCountMatrix.txt",
                     header = TRUE,     # first row contains column names
                     row.names = 1,     # first column is gene IDs
                     sep = "\t",        # tab-delimited file
                     check.names = FALSE)
```

```{r}
seurat_obj_young <- CreateSeuratObject(Young, project = "RPE_scRNA")
seurat_obj_young[["percent.mt"]] <- PercentageFeatureSet(seurat_obj_young, pattern = "^MT-")
seurat_obj_young[["percent.rb"]] <- PercentageFeatureSet(seurat_obj_young, pattern = "^RPS|^RPL")

# Add metadata
seurat_obj_young[["condition"]] <- "Control"
```

```{r}
seurat_obj_young <- SCTransform(seurat_obj_young, 
                          vars.to.regress = c("percent.mt", "percent.rb"),
                          conserve.memory = TRUE, verbose = FALSE)
```

```{r}
# Principal component analysis
seurat_obj_young <- RunPCA(seurat_obj_young, verbose = FALSE)

# UMAP
seurat_obj_young <- RunUMAP(seurat_obj_young, dims = 1:30, umap.method = "uwot")
```

```{r}
DimPlot(seurat_obj_young, reduction = "pca")
```

```{r}
DimPlot(seurat_obj_young, reduction = "umap")
```

```{r}
saveRDS(seurat_obj_young, file = "/Users/chris1219/Desktop/H9_RPE_YOUNG_Analysed_Object.rds")
```
