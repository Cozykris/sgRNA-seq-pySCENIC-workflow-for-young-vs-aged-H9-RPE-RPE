---
title: "DE analysis "
author: "Chris Hui"
date: "2025-09-22"
output: html_document
---


```{r}
seurat_obj <- readRDS("/Users/chris1219/Desktop/seuratobject.rds")
```

```{r,message=FALSE}
library(here)
library(tidyverse)
library(Seurat)
library(scuttle)
library(ggplot2)
library(ggrepel)
library(SingleR)
library(DT)
```

```{r}
auc_mtx = read.csv("~/Desktop/auc_mtx_real.csv")
auc_long <- auc_mtx %>%
  pivot_longer(
    cols = -Cell,       
    names_to = "TF",    
    values_to = "Score" 
  )

auc_long$TF_clean <- sub("\\.\\.\\..*$", "", auc_long$TF)

valid_all_tfs <- intersect(auc_long$TF_clean, rownames(seurat_obj))
valid_all_tfs
 
```



